var util=require("util"),async=require("async"),npmlog=require("npmlog"),luna=require("./luna"),path=require("path"),novacom=require("./novacom");
(function(){var b=npmlog;b.heading="deviceInfo";b.level="warn";var k={log:b,systemInfo:function(a,e){if("function"!==typeof e)throw Error("Missing completion callback (next="+util.inspect(e)+")");a=a||{};async.series([function(b){a.nReplies=1;a.session=new novacom.Session(a.device,b)},function(f){b.verbose("deviceInfo#systemInfo#_getSystemInfo()");var c=a.session.getDevice().lunaAddr.deviceInfo,e={keys:["modelName","sdkVersion","firmwareVersion","boardType","otaId"],subscribe:!1};luna.sendWithoutErrorHandle(a,
c,e,function(a,f){b.silly("deviceInfo#systemInfo#_getSystemInfo():","lineObj:",a);var d=a;if(d){b.verbose("deviceInfo#systemInfo#_getSystemInfo():","success");var c=e.keys;b.verbose("deviceInfo#systemInfo#_makeReturn()");var h="",g;for(g in c)d.hasOwnProperty(c[g])&&(h+=c[g]+" : "+d[c[g]]+"\n");0==h.length&&f(Error("luna-send command failed"+(d.errorText?" ("+d.errorText+")":d.errorMessage?" ("+d.errorMessage+")":"")));d=h.trim();f(null,d)}else b.verbose("deviceInfo#systemInfo#_getSystemInfo():",
"failure"),f(Error("object format error"))},f)}],function(a,c){b.verbose("deviceInfo#systemInfo()","err: ",a,"results:",c);e(a,c[1])})}};"undefined"!==typeof module&&module.exports&&(module.exports=k)})();
